<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-2.1.xsd">

    <!-- Card -->
    <entity entity-name="CardBrand" package="banqio.card" short-alias="BanqioCardBrand">
        <field name="brandId" type="id" is-pk="true"/>
        <field name="externalBrandId" type="text-medium"/>
        <field name="brandName" type="text-medium" enable-localization="true"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="inputUserId" type="id" default="ec.user.userId"/>
        <field name="updateUserId" type="id" default="ec.user.userId"/>

        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_BRAND_INPUT_USR_FK" short-alias="inputUser">
            <key-map field-name="inputUserId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_BRAND_UPDATE_USR_FK" short-alias="updateUser">
            <key-map field-name="updateUserId"/>
        </relationship>

        <index name="cardBrandIdx1" unique="true">
            <index-field name="externalBrandId"/>
        </index>
    </entity>
    <entity entity-name="CardType" package="banqio.card" short-alias="BanqioCardType">
        <field name="typeId" type="id" is-pk="true"/>
        <field name="externalTypeId" type="text-medium"/>
        <field name="typeName" type="text-medium" enable-localization="true"/>
        <field name="typeBehaviourEnumId" type="id"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="inputUserId" type="id" default="ec.user.userId"/>
        <field name="updateUserId" type="id" default="ec.user.userId"/>

        <relationship type="one" title="CardTypeBehaviour" related="moqui.basic.Enumeration" short-alias="typeBehaviour">
            <key-map field-name="typeBehaviourEnumId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_TYPE_INPUT_USR_FK" short-alias="inputUser">
            <key-map field-name="inputUserId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_TYPE_UPDATE_USR_FK" short-alias="updateUser">
            <key-map field-name="updateUserId"/>
        </relationship>

        <index name="cardTypeIdx1" unique="true">
            <index-field name="externalTypeId"/>
        </index>
    </entity>
    <entity entity-name="CardStatus" package="banqio.card" short-alias="BanqioCardStatus">
        <field name="statusId" type="id" is-pk="true"/>
        <field name="externalStatusId" type="text-medium"/>
        <field name="statusName" type="text-medium" enable-localization="true"/>
        <field name="statusBehaviourEnumId" type="id"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="inputUserId" type="id" default="ec.user.userId"/>
        <field name="updateUserId" type="id" default="ec.user.userId"/>

        <relationship type="one" title="CardStatusBehaviour" related="moqui.basic.Enumeration" short-alias="statusBehaviour">
            <key-map field-name="statusBehaviourEnumId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_STAT_INPUT_USR_FK" short-alias="inputUser">
            <key-map field-name="inputUserId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_STAT_UPDATE_USR_FK" short-alias="updateUser">
            <key-map field-name="updateUserId"/>
        </relationship>

        <index name="cardStatusIdx1" unique="true">
            <index-field name="externalStatusId"/>
        </index>
    </entity>

    <!-- Card lock -->
    <entity entity-name="CardTemporaryLock" package="banqio.card">
        <field name="lockId" type="id" is-pk="true"/>
        <field name="appId" type="id"/>
        <field name="lockReasonEnumId" type="id"/>
        <field name="customerId" type="text-medium"/>
        <field name="cardId" type="text-medium"/>
        <field name="cardNumber" type="text-medium"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="expiryDate" type="date-time"/>

        <relationship type="one" related="commons.server.App" short-alias="app">
            <key-map field-name="appId"/>
        </relationship>
        <relationship type="one" title="CardLockReason" related="moqui.basic.Enumeration" short-alias="lockReason">
            <key-map field-name="lockReasonEnumId"/>
        </relationship>

        <index name="cardTemporaryLockIdx1">
            <index-field name="customerId"/>
            <index-field name="cardId"/>
        </index>
        <index name="cardTemporaryLockIdx2">
            <index-field name="customerId"/>
        </index>
    </entity>
    <entity entity-name="CardPermanentLock" package="banqio.card">
        <field name="lockId" type="id" is-pk="true"/>
        <field name="appId" type="id"/>
        <field name="lockReasonEnumId" type="id"/>
        <field name="customerId" type="text-medium"/>
        <field name="cardId" type="text-medium"/>
        <field name="cardNumber" type="text-medium"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>

        <relationship type="one" related="commons.server.App" short-alias="app">
            <key-map field-name="appId"/>
        </relationship>
        <relationship type="one" title="CardLockReason" related="moqui.basic.Enumeration" short-alias="lockReason">
            <key-map field-name="lockReasonEnumId"/>
        </relationship>

        <index name="cardPermanentLockIdx1">
            <index-field name="customerId"/>
            <index-field name="cardId"/>
        </index>
        <index name="cardPermanentLockIdx2">
            <index-field name="customerId"/>
        </index>
    </entity>

    <!-- TODO: Review package name and add FK names -->
    <!--<entity entity-name="CardPinChangeRequest" package="banqio.card.audit">
        <field name="requestId" type="id" is-pk="true"/>
        <field name="appId" type="id"/>
        <field name="customerId" type="text-medium"/>
        <field name="cardId" type="text-medium"/>
        <field name="successful" type="text-indicator"/>
        <field name="errors" type="text-very-long"/>
        <field name="creationDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="inputUserId" type="id"/>
        <field name="targetUserId" type="id"/>

        <relationship type="one" related="commons.server.App">
            <key-map field-name="appId"/>
        </relationship>

        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_PIN_CHANGE_INPUT_USR_FK" short-alias="inputUser">
            <key-map field-name="inputUserId"/>
        </relationship>
        <relationship type="one" related="moqui.security.UserAccount" fk-name="CARD_PIN_CHANGE_UPDATE_USR_FK" short-alias="updateUser">
            <key-map field-name="updateUserId"/>
        </relationship>
    </entity>-->

</entities>