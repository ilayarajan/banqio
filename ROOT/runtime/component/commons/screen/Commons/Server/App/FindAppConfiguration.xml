<?xml version="1.0" encoding="UTF-8"?>
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns=""
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-2.1.xsd"
        default-menu-title="Configuration"
        default-menu-index="6">

    <parameter name="appId" required="true"/>

    <transition name="updateConfiguration">
        <service-call name="update#commons.server.Configuration"/>
        <default-response url="."/>
    </transition>

    <actions>
        <entity-find entity-name="commons.server.ConfigurationGroup" list="groupList">
            <order-by field-name="position"/>
            <order-by field-name="groupName"/>
        </entity-find>
    </actions>

    <widgets>
        <section-iterate name="ConfigGroupIterator" list="groupList" entry="group">
            <actions>
                <entity-find entity-name="commons.server.Configuration" list="configList">
                    <econdition field-name="appId" from="appId"/>
                    <econdition field-name="groupId" from="group.groupId"/>
                    <order-by field-name="configurationName"/>
                </entity-find>
            </actions>
            <widgets>
                <section name="ListConfigSection" condition="configList">
                    <widgets>
                        <label text="${group.groupName}" type="h2"/>
                        <form-list name="ListConfig" list="configList" paginate="false" transition="updateConfiguration">
                            <field name="configurationId">
                                <default-field>
                                    <hidden/>
                                </default-field>
                            </field>
                            <field name="appId">
                                <default-field>
                                    <hidden/>
                                </default-field>
                            </field>
                            <field name="configurationName">
                                <default-field>
                                    <label text="${configurationName}" tooltip="${configurationId}"/>
                                    <label text="&lt;br&gt;" encode="false"/>
                                    <label text="${description}" style="text-muted small"/>
                                </default-field>
                            </field>
                            <field name="defaultValue">
                                <default-field>
                                    <display/>
                                </default-field>
                            </field>
                            <field name="definedValue">
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_TEXTFIELD')">
                                    <text-line/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_TEXTAREA')">
                                    <text-area rows="4" cols="80"/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_PASSWORD')">
                                    <password/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_COMBO')">
                                    <drop-down>
                                        <entity-options key="${optionValue}" text="${optionText}">
                                            <entity-find entity-name="commons.server.ConfigurationOption">
                                                <econdition field-name="configurationId" from="configurationId"/>
                                                <order-by field-name="optionSeqId"/>
                                            </entity-find>
                                        </entity-options>
                                    </drop-down>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_CHECK')">
                                    <check>
                                        <entity-options key="${optionValue}" text="${optionText}">
                                            <entity-find entity-name="commons.server.ConfigurationOption">
                                                <econdition field-name="configurationId" from="configurationId"/>
                                                <order-by field-name="optionSeqId"/>
                                            </entity-find>
                                        </entity-options>
                                    </check>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_RADIO')">
                                    <radio>
                                        <entity-options key="${optionValue}" text="${optionText}">
                                            <entity-find entity-name="commons.server.ConfigurationOption">
                                                <econdition field-name="configurationId" from="configurationId"/>
                                                <order-by field-name="optionSeqId"/>
                                            </entity-find>
                                        </entity-options>
                                    </radio>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_FILE')">
                                    <file/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_DATE')">
                                    <date-time type="date"/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_TIME')">
                                    <date-time type="time"/>
                                </conditional-field>
                                <conditional-field condition="editorTypeEnumId.equals('CONF_EDITOR_TIMESTAMP')">
                                    <date-time/>
                                </conditional-field>
                                <default-field>
                                    <text-line/>
                                </default-field>
                            </field>
                            <field name="submitButton">
                                <default-field title="Update" container-style="text-left">
                                    <submit/>
                                </default-field>
                            </field>
                        </form-list>
                    </widgets>
                </section>
            </widgets>
        </section-iterate>
    </widgets>
</screen>